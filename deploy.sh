#!/bin/bash

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
OUTPUT_DIR="output"
TEMP_DIR="/tmp/manual_site_output"
BRANCH_MAIN="main"
BRANCH_DEPLOY="gh-pages"

# 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ output
echo "üìÅ –ö–æ–ø–∏—Ä—É–µ–º $OUTPUT_DIR –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é..."
rm -rf "$TEMP_DIR"
mkdir -p "$TEMP_DIR"
cp -r $OUTPUT_DIR/* "$TEMP_DIR"

# 2. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–µ—Ç–∫—É gh-pages
echo "üîÅ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–µ—Ç–∫—É $BRANCH_DEPLOY..."
git checkout $BRANCH_DEPLOY || exit 1

# 3. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã (HTML –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
echo "üßπ –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ HTML-—Ñ–∞–π–ª—ã..."
rm -rf *.html images

# 4. –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–ø–∫–∏
echo "üì• –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã..."
cp -r "$TEMP_DIR"/* .

# 5. –î–æ–±–∞–≤–ª—è–µ–º, –∫–æ–º–º–∏—Ç–∏–º, –ø—É—à–∏–º
echo "üìù –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è..."
git add .
git commit -m "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞: $(date '+%d.%m.%Y %H:%M')" || echo "‚ö†Ô∏è –ù–µ—á–µ–≥–æ –∫–æ–º–º–∏—Ç–∏—Ç—å"
git push origin $BRANCH_DEPLOY

# 6. –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ main
echo "üîô –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –≤–µ—Ç–∫—É $BRANCH_MAIN..."
git checkout $BRANCH_MAIN

echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"
